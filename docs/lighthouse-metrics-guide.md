# Lighthouse 성능 지표 가이드

> 이 문서는 Lighthouse의 성능 지표가 무엇이고, 각 수치가 의미하는 바를 정리한 기술 블로그 포스트용 자료입니다.
>
> 관련 문서: [lighthouse-optimization-log.md](./lighthouse-optimization-log.md) — 실제 프로젝트에서 이 지표들을 개선한 과정

---

## Lighthouse란?

Google이 만든 **웹 페이지 품질 측정 도구**이다.
Chrome DevTools, CLI, 또는 PageSpeed Insights에서 실행할 수 있으며,
페이지를 실제로 로드하면서 다양한 지표를 측정한다.

### 측정 카테고리

| 카테고리           | 측정 내용                                  |
| ------------------ | ------------------------------------------ |
| **Performance**    | 페이지 로딩 속도 및 반응성                 |
| **Accessibility**  | 접근성 (스크린 리더, 키보드 내비게이션 등) |
| **Best Practices** | 웹 표준 준수 여부                          |
| **SEO**            | 검색 엔진 최적화                           |

이 문서에서는 **Performance** 카테고리의 핵심 지표를 다룬다.

---

## 성능 점수 계산 방식

Lighthouse 성능 점수(0~100)는 아래 6개 지표의 **가중 평균**으로 계산된다.

| 지표    | 가중치 | 한 줄 설명                            |
| ------- | ------ | ------------------------------------- |
| **FCP** | 10%    | 첫 콘텐츠가 보이는 시점               |
| **SI**  | 10%    | 콘텐츠가 채워지는 속도                |
| **LCP** | 25%    | 가장 큰 콘텐츠가 보이는 시점          |
| **TBT** | 30%    | 메인 스레드가 막힌 총 시간            |
| **CLS** | 25%    | 레이아웃이 얼마나 흔들리는지          |
| **INP** | —      | 사용자 인터랙션 반응 속도 (참고 지표) |

> TBT(30%)와 LCP(25%)가 전체 점수의 절반 이상을 차지한다.

---

## 각 지표 상세 설명

### 1. FCP (First Contentful Paint) — 가중치 10%

**화면에 첫 번째 콘텐츠가 나타나기까지 얼마나 걸리는지를 측정한다.**

사용자가 페이지에 접속한 후 텍스트, 이미지, SVG 등 무엇이든 처음 화면에 보이는 시점이다.
이 시점 전까지 사용자는 빈 화면만 보게 된다.

```
페이지 요청 ──────────────────── FCP ──────────── 로딩 완료
                                  ↑
                          텍스트, 이미지, SVG 등
                          첫 번째 콘텐츠가 렌더링됨
```

| 등급        | 시간        |
| ----------- | ----------- |
| 좋음 (녹색) | 0 ~ 1.8초   |
| 보통 (주황) | 1.8 ~ 3.0초 |
| 나쁨 (빨강) | 3.0초 이상  |

**영향 요인:**

- 서버 응답 시간 (TTFB)
- 렌더링을 차단하는 CSS/JS (아래 설명)
- 웹폰트 로딩 시간

**렌더링 차단 CSS/JS 란?**

브라우저는 HTML을 위에서 아래로 읽으면서 화면을 그리는데,
중간에 CSS나 JS 파일을 만나면 **그 파일을 다운로드하고 처리할 때까지 화면 그리기를 멈춘다.**

```
HTML 파싱 중:

<head>
  <link rel="stylesheet" href="style.css">   ← 여기서 멈춤! (CSS 다운로드 + 파싱 완료까지 대기)
  <script src="app.js"></script>              ← 여기서도 멈춤! (JS 다운로드 + 실행 완료까지 대기)
</head>
<body>
  <h1>안녕하세요</h1>                          ← CSS 파싱 + JS 실행이 끝나야 비로소 화면에 표시됨
</body>
```

즉, CSS/JS 파일이 크거나 느리면 그만큼 FCP가 늦어진다.
이를 해결하려면 `async`/`defer` 속성으로 JS 로딩을 비차단으로 바꾸거나,
크리티컬하지 않은 CSS를 나중에 로드하는 방법이 있다.

---

### 2. LCP (Largest Contentful Paint) — 가중치 25%

**페이지에서 가장 큰 콘텐츠를 브라우저가 얼마나 빨리 화면에 그리는지를 측정한다.**

뷰포트 내에서 가장 큰 요소(메인 이미지, 큰 텍스트 블록 등)가 완전히 렌더링되는 시점이다.
이 시점이 곧 사용자가 "페이지가 로드됐다"고 느끼는 순간이다.

```
페이지 요청 ─── FCP ──────────── LCP ──────────── 로딩 완료
                ↑                 ↑
           작은 텍스트 표시   메인 이미지 로드 완료
                              (가장 큰 요소)
```

| 등급        | 시간        |
| ----------- | ----------- |
| 좋음 (녹색) | 0 ~ 2.5초   |
| 보통 (주황) | 2.5 ~ 4.0초 |
| 나쁨 (빨강) | 4.0초 이상  |

**LCP 후보가 되는 요소:**

- `<img>` 태그
- `<video>` 태그의 포스터 이미지
- CSS `background-image`가 있는 요소
- 큰 텍스트 블록 (`<h1>`, `<p>` 등)

**영향 요인:**

- 이미지 용량과 로딩 전략 (`fetchpriority`, `loading`)
- 서버 사이드 렌더링 여부 (초기 HTML에 이미지 URL이 포함되는지)
- CSS/JS가 렌더링을 차단하는지

**이 프로젝트에서의 사례:**
상품 썸네일 이미지가 LCP 요소였고, 클라이언트에서만 데이터를 가져와
초기 HTML에 이미지 URL이 없었다. → SSR로 초기 데이터를 포함시켜 개선.
자세한 내용: [lighthouse-optimization-log.md — 2차 분석](./lighthouse-optimization-log.md#2차-분석--lcp-request-discovery-2026-02-10)

---

### 3. TBT (Total Blocking Time) — 가중치 30%

**사용자가 클릭이나 입력을 해도 페이지가 반응하지 못한 시간이 총 얼마인지를 측정한다.**

FCP와 TTI(Time to Interactive) 사이에서,
브라우저가 JavaScript를 실행하느라 사용자 입력을 처리하지 못한 시간을 합산한 값이다.
각 작업에서 50ms를 초과한 부분만 차단 시간으로 계산한다.

```
메인 스레드 작업 타임라인:

작업A (30ms)  작업B (120ms)       작업C (80ms)
|████████|    |████████████████|   |██████████████|
              |   50ms   | 70ms |  | 50ms | 30ms |
              (허용치)  (차단시간)  (허용치)(차단시간)

TBT = 70ms + 30ms = 100ms
```

| 등급        | 시간        |
| ----------- | ----------- |
| 좋음 (녹색) | 0 ~ 200ms   |
| 보통 (주황) | 200 ~ 600ms |
| 나쁨 (빨강) | 600ms 이상  |

**영향 요인:**

- JavaScript 번들 크기
- 서드파티 스크립트
- 비효율적인 JavaScript 실행 (큰 루프, 동기적 작업 등)

---

### 4. CLS (Cumulative Layout Shift) — 가중치 25%

**페이지 로딩 중에 콘텐츠가 갑자기 밀리거나 이동하는 현상이 얼마나 발생하는지를 측정한다.**

예를 들어, 글을 읽고 있는데 갑자기 광고가 로드되면서 텍스트가 아래로 밀리는 현상이다.

```
로딩 중:                      광고 로드 후:
┌──────────────┐              ┌──────────────┐
│   헤더       │              │   헤더       │
│              │              │   [광고]     │  ← 갑자기 삽입됨
│   본문 텍스트 │  ──────→    │              │
│   여기를 클릭 │              │   본문 텍스트 │  ← 아래로 밀림
│              │              │   여기를 클릭 │  ← 클릭하려던 곳이 이동됨!
└──────────────┘              └──────────────┘
```

| 등급        | 점수       |
| ----------- | ---------- |
| 좋음 (녹색) | 0 ~ 0.1    |
| 보통 (주황) | 0.1 ~ 0.25 |
| 나쁨 (빨강) | 0.25 이상  |

**영향 요인:**

- 크기가 지정되지 않은 이미지/동영상 (`width`, `height` 미설정)
- 동적으로 삽입되는 콘텐츠 (광고, 배너 등)
- 웹폰트 로드 시 텍스트 크기 변경 (FOUT/FOIT)

---

### 5. SI (Speed Index) — 가중치 10%

**페이지가 로딩되는 동안 화면이 얼마나 빠르게 콘텐츠로 채워지는지를 측정한다.**

페이지 로딩 과정을 영상으로 캡처하여, 빈 화면에서 완성된 화면까지 얼마나 빠르게 진행되는지를 수치화한다.

```
시간 →

페이지 A (SI 낮음 = 좋음):
  10% ████
  50% ████████████████████
  90% ████████████████████████████████████
 100% ████████████████████████████████████████
      빠르게 콘텐츠가 채워짐

페이지 B (SI 높음 = 나쁨):
  10% ██
  50% ████
  90% ████████
 100% ████████████████████████████████████████
      한참 후에야 콘텐츠가 채워짐
```

| 등급        | 시간        |
| ----------- | ----------- |
| 좋음 (녹색) | 0 ~ 3.4초   |
| 보통 (주황) | 3.4 ~ 5.8초 |
| 나쁨 (빨강) | 5.8초 이상  |

---

### 6. INP (Interaction to Next Paint) — 참고 지표

**사용자가 버튼을 클릭하거나 키보드를 입력한 후, 화면이 실제로 반응하기까지 걸리는 시간을 측정한다.**

2024년 3월부터 FID(First Input Delay)를 대체하여 Core Web Vitals에 포함되었다.
Lighthouse에서는 점수에 반영되지 않는 참고 지표로 표시된다.

```
사용자가 버튼 클릭 → [처리 시간] → 화면에 결과 반영
                     ^^^^^^^^^^
                     이 시간이 INP
```

| 등급        | 시간        |
| ----------- | ----------- |
| 좋음 (녹색) | 0 ~ 200ms   |
| 보통 (주황) | 200 ~ 500ms |
| 나쁨 (빨강) | 500ms 이상  |

---

## 지표 간의 관계

```
페이지 로딩 타임라인:

요청 ─── TTFB ─── FCP ────── LCP ────── TTI ────── 완전 로드
         ↑        ↑          ↑          ↑
     서버 응답  첫 콘텐츠   메인 콘텐츠  인터랙션 가능
                  표시       표시

         |←──── SI (시각적 완성 속도) ────→|
                  |←─── TBT (차단 시간 합) ──→|
         |←──────── CLS (레이아웃 이동 누적) ─────────→|
```

- **TTFB**가 느리면 → FCP, LCP 모두 느려짐
- **FCP**가 느리면 → TBT 측정 구간이 길어져 TBT도 증가 가능
- **LCP**가 느리면 → 성능 점수 25% 가중치에 직접 영향
- **TBT**가 높으면 → 성능 점수 30% 가중치에 직접 영향, 사용자 체감 반응성 저하
- **CLS**가 높으면 → 사용자 경험 저하, 성능 점수 25% 가중치에 직접 영향

---

## 점수별 의미

| 점수 범위 | 의미      | 색상 |
| --------- | --------- | ---- |
| 90 ~ 100  | 좋음      | 녹색 |
| 50 ~ 89   | 개선 필요 | 주황 |
| 0 ~ 49    | 나쁨      | 빨강 |

---

## 측정 시 주의사항

- **네트워크/기기 시뮬레이션**: Lighthouse는 기본적으로 중간 사양 모바일 기기 + 느린 4G 네트워크를 시뮬레이션하므로, 실제 체감보다 점수가 낮게 나올 수 있다
- **측정 환경에 따른 편차**: 같은 페이지라도 측정할 때마다 점수가 약간씩 달라질 수 있다. 3~5회 측정 후 평균을 사용하는 것이 정확하다
- **Chrome 확장 프로그램 영향**: DevTools에서 측정 시, 설치된 확장 프로그램이 결과에 영향을 줄 수 있다. 시크릿 모드에서 측정하는 것이 좋다
- **개발 모드 vs 프로덕션 모드**: Next.js 등 프레임워크의 개발 모드는 최적화가 비활성화되어 있으므로, 반드시 프로덕션 빌드에서 측정해야 한다
